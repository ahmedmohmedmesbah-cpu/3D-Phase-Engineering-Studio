<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3D Phase - Ahmed Mesbah</title>
  <meta name="description" content="Portfolio of Ahmed Mesbah, a Mechanical & SolidWorks Designer and the founder of 3D Phase Engineering Studio. Specializing in 3D modeling, CAD, and manufacturing-ready documentation.">
  <meta property="og:title" content="3D Phase - Ahmed Mesbah Portfolio">
  <meta property="og:description" content="Showcasing expertise in 3D modeling, robotics, product design, and prototyping.">
  <meta property="og:image" content="https://picsum.photos/1200/630">
  <meta property="og:type" content="website">

  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    :root {
      --color-bg: #FFFFFF;
      --color-text: #1A1A1A;
      --color-accent: #0A6BFF;
      --color-muted: #F3F5F7;
      --color-border: #E5E7EB;
      --color-focus: #111827;
    }
    @media (prefers-reduced-motion: reduce) {
      html {
        scroll-behavior: auto;
      }
    }
  </style>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            heading: ['Poppins', 'sans-serif'],
          },
          colors: {
            background: 'var(--color-bg)',
            text: 'var(--color-text)',
            accent: 'var(--color-accent)',
            muted: 'var(--color-muted)',
            border: 'var(--color-border)',
          }
        }
      }
    }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Load THREE.js globally -->
  <script src="https://unpkg.com/three@0.157.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.157.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://unpkg.com/three@0.157.0/examples/js/controls/OrbitControls.js"></script>

<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "three": "https://aistudiocdn.com/three@^0.179.1",
    "three/": "https://aistudiocdn.com/three@^0.179.1/"
  }
}
</script>
</head>
<body class="bg-background text-text font-sans antialiased">
  <div id="root"></div>

  <script type="text/babel">
    // All React components are now inlined here to avoid MIME type errors on GitHub Pages.
    // React and ReactDOM are available globally from the script tags in the <head>.

    const { useState, useRef, useEffect, forwardRef } = React;

    // --- From hooks/useOnScreen.ts ---
    function useOnScreen(ref, rootMargin = '0px') {
      const [isIntersecting, setIntersecting] = useState(false);
      useEffect(() => {
        if (!ref.current) return;
        const observer = new IntersectionObserver(
          ([entry]) => setIntersecting(entry.isIntersecting),
          { rootMargin, threshold: 0.5 }
        );
        const currentRef = ref.current;
        observer.observe(currentRef);
        return () => {
            if(currentRef) {
                observer.unobserve(currentRef);
            }
        };
      }, [ref, rootMargin]);
      return isIntersecting;
    }

    // --- From components/Header.tsx ---
    const NavLink = ({ href, label, isCurrent }) => (
      <a
        href={href}
        className={`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-300 ${
          isCurrent ? 'text-accent font-semibold' : 'text-text/70 hover:text-text'
        }`}
      >
        {label}
      </a>
    );

    const Header = ({ sectionRefs }) => {
      const [hasScrolled, setHasScrolled] = useState(false);
      const isAboutVisible = useOnScreen(sectionRefs.about, "-30%");
      const isProjectsVisible = useOnScreen(sectionRefs.projects, "-30%");
      const isContactVisible = useOnScreen(sectionRefs.contact, "-30%");

      let currentSection = '';
      if (isContactVisible) currentSection = 'contact';
      else if (isProjectsVisible) currentSection = 'projects';
      else if (isAboutVisible) currentSection = 'about';

      useEffect(() => {
        const handleScroll = () => setHasScrolled(window.scrollY > 10);
        window.addEventListener('scroll', handleScroll);
        return () => window.removeEventListener('scroll', handleScroll);
      }, []);

      const navLinks = [
        { href: '#about', label: 'About', id: 'about' },
        { href: '#projects', label: 'Projects', id: 'projects' },
        { href: '#contact', label: 'Contact', id: 'contact' },
      ];

      return (
        <header className={`sticky top-0 z-40 w-full transition-shadow duration-300 ${hasScrolled ? 'shadow-md bg-background/80 backdrop-blur-sm' : 'bg-transparent'}`}>
          <div className="container mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
            <div className="flex items-center justify-between h-20">
              <a href="#about" className="text-xl font-bold font-heading text-text">
                3D Phase
              </a>
              <nav aria-label="Primary" className="hidden md:flex items-center space-x-2">
                {navLinks.map((link) => (
                  <NavLink key={link.id} href={link.href} label={link.label} isCurrent={currentSection === link.id} />
                ))}
              </nav>
            </div>
          </div>
        </header>
      );
    };

    // --- From components/AboutSection.tsx ---
    const AboutSection = forwardRef((props, ref) => {
      const capabilities = [
        "3D modeling (parts/assemblies)", "SolidWorks surface modeling", "Technical drawings",
        "FEA stress checks", "Prototyping support", "DFM/DFA guidelines",
        "Basic motion studies", "Handoff for fabrication",
      ];
      const tools = ["SolidWorks", "Blender", "KeyShot", "Python", "Git"];

      return (
        <section id="about" ref={ref} className="py-20 lg:py-32 bg-muted">
          <div className="container mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-center">
              <div className="order-2 lg:order-1">
                <h2 id="about-title" className="text-3xl lg:text-4xl font-bold font-heading text-text mb-6">About Me</h2>
                <p className="text-lg text-text/80 mb-6">
                  I am Ahmed Mesbah, a Mechanical & SolidWorks Designer and the founder of 3D Phase Engineering Studio. I specialize in 3D modeling, CAD for assemblies, surface modeling, and manufacturing-ready documentation. My work bridges engineering precision with creative problem-solving across robotics, product design, and prototyping.
                </p>
                <div className="mb-6">
                  <h3 className="text-xl font-semibold font-heading mb-3">Capabilities</h3>
                  <ul className="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-2 text-text/70">
                    {capabilities.map((item) => (
                      <li key={item} className="flex items-center">
                        <svg className="w-4 h-4 mr-2 text-accent flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd"></path></svg>
                        {item}
                      </li>
                    ))}
                  </ul>
                </div>
                <div>
                  <h3 className="text-xl font-semibold font-heading mb-3">Tools</h3>
                  <div className="flex flex-wrap gap-2">
                    {tools.map(tool => (
                      <span key={tool} className="bg-border text-text/80 text-sm font-medium px-3 py-1 rounded-full">{tool}</span>
                    ))}
                  </div>
                </div>
              </div>
              <div className="order-1 lg:order-2 flex justify-center">
                <img src="https://picsum.photos/seed/profile/500/500" alt="Ahmed Mesbah" className="rounded-full w-64 h-64 lg:w-96 lg:h-96 object-cover shadow-xl" />
              </div>
            </div>
          </div>
        </section>
      );
    });

    // --- From components/ProjectCard.tsx ---
    const ProjectCard = ({ project, onProjectSelect }) => {
      return (
        <div
          className="group bg-muted rounded-2xl overflow-hidden shadow-sm hover:shadow-2xl transition-all duration-300 ease-in-out transform hover:-translate-y-2 cursor-pointer"
          onClick={() => onProjectSelect(project)}
          onKeyDown={(e) => (e.key === 'Enter' || e.key === ' ') && onProjectSelect(project)}
          tabIndex={0}
          role="button"
          aria-label={`View details for ${project.title}`}
        >
          <div className="relative overflow-hidden">
            <img
              src={project.cover}
              alt={project.title}
              className="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300"
              loading="lazy"
              decoding="async"
            />
            <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
          </div>
          <div className="p-6">
            <h3 className="text-xl font-bold font-heading text-text mb-2">{project.title}</h3>
            <p className="text-text/70 mb-4">{project.summary}</p>
            <div className="flex flex-wrap gap-2">
              {project.tags.map((tag) => (
                <span key={tag} className="bg-border text-text/80 text-xs font-semibold px-3 py-1 rounded-full capitalize">
                  {tag}
                </span>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // --- From components/ProjectModal.tsx ---
    const ThreeViewer = ({ modelUrl }) => {
      const mountRef = useRef(null);

      useEffect(() => {
        if (!mountRef.current || !window.THREE) return;

        const currentMount = mountRef.current;
        const THREE = window.THREE; // Create a local reference

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xf3f5f7);
        const camera = new THREE.PerspectiveCamera(75, currentMount.clientWidth / currentMount.clientHeight, 0.1, 1000);
        camera.position.z = 5;

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(currentMount.clientWidth, currentMount.clientHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        currentMount.appendChild(renderer.domElement);
        
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.5;

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        const loader = new THREE.GLTFLoader();
        loader.load(
          modelUrl,
          (gltf) => {
            const box = new THREE.Box3().setFromObject(gltf.scene);
            const center = box.getCenter(new THREE.Vector3());
            gltf.scene.position.sub(center);
            scene.add(gltf.scene);
          },
          undefined,
          (error) => console.error('An error happened while loading the model:', error)
        );
        
        const animate = () => {
          requestAnimationFrame(animate);
          controls.update();
          renderer.render(scene, camera);
        };
        animate();

        const handleResize = () => {
          if (!currentMount) return;
          camera.aspect = currentMount.clientWidth / currentMount.clientHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(currentMount.clientWidth, currentMount.clientHeight);
        };
        window.addEventListener('resize', handleResize);

        return () => {
          window.removeEventListener('resize', handleResize);
          if (currentMount && renderer.domElement) {
             try { currentMount.removeChild(renderer.domElement); } catch (e) {}
          }
          renderer.dispose();
        };
      }, [modelUrl]);

      return <div ref={mountRef} className="w-full h-full bg-muted rounded-lg" />;
    };

    const ProjectModal = ({ project, onClose }) => {
      const modalRef = useRef(null);
      const canShow3d = !!project.model;
      const canShowGallery = project.images && project.images.length > 0;
      const [activeTab, setActiveTab] = useState(canShow3d ? '3d' : 'gallery');

      useEffect(() => {
        modalRef.current?.showModal();
        return () => modalRef.current?.close();
      }, []);

      const handleBackdropClick = (event) => {
        if (event.target === modalRef.current) onClose();
      };

      return (
        <dialog ref={modalRef} onClick={handleBackdropClick} className="fixed inset-0 z-50 w-full h-full max-w-none max-h-none m-0 bg-black/50 backdrop-blur-sm p-4">
          <div className="bg-background rounded-2xl shadow-2xl max-w-4xl w-full mx-auto my-8 p-6 sm:p-8 relative animate-fade-in-up flex flex-col max-h-[90vh]">
            <button onClick={onClose} className="absolute top-4 right-4 text-text/50 hover:text-text transition-colors z-10" aria-label="Close project details">
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <div className="flex-shrink-0">
              <h2 className="text-2xl sm:text-3xl font-bold font-heading mb-4 pr-8">{project.title}</h2>
              <p className="text-text/70 mb-6">{project.description}</p>
            </div>
            {canShow3d && canShowGallery && (
              <div className="flex border-b border-border mb-4 flex-shrink-0">
                <button onClick={() => setActiveTab('3d')} className={`px-4 py-2 text-sm font-medium transition-colors ${activeTab === '3d' ? 'border-b-2 border-accent text-accent' : 'text-text/60 hover:text-text'}`} aria-selected={activeTab === '3d'} role="tab">3D Viewer</button>
                <button onClick={() => setActiveTab('gallery')} className={`px-4 py-2 text-sm font-medium transition-colors ${activeTab === 'gallery' ? 'border-b-2 border-accent text-accent' : 'text-text/60 hover:text-text'}`} aria-selected={activeTab === 'gallery'} role="tab">Photos</button>
              </div>
            )}
            <div className="flex-grow overflow-y-auto min-h-[400px] h-[500px]">
              {(activeTab === '3d' && canShow3d) && <ThreeViewer modelUrl={project.model} />}
              {(activeTab === 'gallery' && canShowGallery) && (
                  <div className="w-full h-full flex overflow-x-auto snap-x snap-mandatory gap-4">
                    {project.images.map((img, index) => (
                      <div key={index} className="snap-center flex-shrink-0 w-full h-full flex items-center justify-center">
                        <img src={img} alt={`${project.title} screenshot ${index + 1}`} className="rounded-lg h-full w-auto object-contain" />
                      </div>
                    ))}
                  </div>
              )}
            </div>
            <div className="flex flex-wrap gap-2 mt-6 flex-shrink-0">
              <span className="font-semibold mr-2">Tools:</span>
              {project.tools.map(tool => (<span key={tool} className="bg-muted text-text/80 text-sm font-medium px-3 py-1 rounded-full">{tool}</span>))}
            </div>
          </div>
          <style>{`
              dialog[open] { display: flex; align-items: center; justify-content: center; }
              @keyframes fade-in-up {
                from { opacity: 0; transform: translateY(20px) scale(0.98); }
                to { opacity: 1; transform: translateY(0) scale(1); }
              }
              .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }
          `}</style>
        </dialog>
      );
    };

    // --- From components/ProjectsSection.tsx ---
    const ProjectsSection = forwardRef(({ onProjectSelect }, ref) => {
      const [projects, setProjects] = useState([]);
      const [isLoading, setIsLoading] = useState(true);

      useEffect(() => {
        fetch('data/projects.json')
          .then(res => res.ok ? res.json() : Promise.reject(res))
          .then(data => setProjects(data))
          .catch(error => console.error("Failed to fetch projects:", error))
          .finally(() => setIsLoading(false));
      }, []);

      return (
        <section id="projects" ref={ref} className="py-20 lg:py-32">
          <div className="container mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
            <div className="text-center mb-12">
              <h2 id="projects-title" className="text-3xl lg:text-4xl font-bold font-heading text-text">My Work</h2>
              <p className="mt-4 text-lg text-text/70">A selection of my recent projects.</p>
            </div>
            {isLoading ? <div className="text-center">Loading projects...</div> : (
              <div className="grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-12">
                {projects.map((project) => (
                  <ProjectCard key={project.id} project={project} onProjectSelect={onProjectSelect} />
                ))}
              </div>
            )}
          </div>
        </section>
      );
    });
    
    // --- From components/ContactSection.tsx ---
    const ContactSection = forwardRef((props, ref) => {
      return (
        <section id="contact" ref={ref} className="py-20 lg:py-32 bg-muted">
          <div className="container mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
            <div className="text-center mb-12">
              <h2 id="contact-title" className="text-3xl lg:text-4xl font-bold font-heading text-text">Get In Touch</h2>
              <p className="mt-4 text-lg text-text/70">Have a project in mind? I'd love to hear from you.</p>
            </div>
            <div className="max-w-3xl mx-auto">
              <div className="bg-background p-8 rounded-2xl shadow-lg">
                <form action="https://formspree.io/f/YOUR_FORM_ID" method="POST">
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                      <label htmlFor="name" className="block text-sm font-medium text-text/80 mb-2">Name</label>
                      <input type="text" name="name" id="name" required className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-shadow" />
                    </div>
                    <div>
                      <label htmlFor="email" className="block text-sm font-medium text-text/80 mb-2">Email</label>
                      <input type="email" name="email" id="email" required className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-shadow" />
                    </div>
                  </div>
                  <div className="mb-6">
                    <label htmlFor="message" className="block text-sm font-medium text-text/80 mb-2">Message</label>
                    <textarea name="message" id="message" rows={5} required minLength={20} className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-shadow"></textarea>
                  </div>
                  <button type="submit" className="w-full bg-accent text-white font-bold py-3 px-6 rounded-lg hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent transition-opacity">
                    Send Message
                  </button>
                </form>
              </div>
              <div className="text-center mt-12">
                <p className="text-text/70 mb-4">Or reach out directly:</p>
                <div className="flex flex-col sm:flex-row justify-center items-center gap-4 sm:gap-8">
                    <a href="mailto:ahmedmohmedmesbah@gmail.com" className="font-semibold text-accent hover:underline">ahmedmohmedmesbah@gmail.com</a>
                    <span className="hidden sm:inline text-border">|</span>
                    <a href="https://wa.me/201002500273" className="font-semibold text-accent hover:underline">WhatsApp</a>
                    <span className="hidden sm:inline text-border">|</span>
                    <a href="https://www.linkedin.com/in/ahmed-mohmedmesbah-b35901259" target="_blank" rel="noopener noreferrer" className="font-semibold text-accent hover:underline">LinkedIn</a>
                </div>
              </div>
            </div>
          </div>
        </section>
      );
    });

    // --- From components/Footer.tsx ---
    const Footer = () => {
      const currentYear = new Date().getFullYear();
      return (
        <footer className="bg-text text-muted py-6">
          <div className="container mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8 text-center text-sm">
            <p>&copy; {currentYear} 3D Phase — Ahmed Mesbah. All Rights Reserved.</p>
          </div>
        </footer>
      );
    };

    // --- From App.tsx ---
    const App = () => {
      const [selectedProject, setSelectedProject] = useState(null);
      const aboutRef = useRef(null);
      const projectsRef = useRef(null);
      const contactRef = useRef(null);
      const sectionRefs = { about: aboutRef, projects: projectsRef, contact: contactRef };

      const openProjectModal = (project) => {
        setSelectedProject(project);
        document.body.style.overflow = 'hidden';
      };

      const closeProjectModal = () => {
        setSelectedProject(null);
        document.body.style.overflow = '';
      };

      useEffect(() => {
        const handleKeyDown = (event) => {
          if (event.key === 'Escape' && selectedProject) closeProjectModal();
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => {
          window.removeEventListener('keydown', handleKeyDown);
          document.body.style.overflow = '';
        };
      }, [selectedProject]);

      return (
        <div className="flex flex-col min-h-screen">
          <a href="#main" className="absolute left-[-9999px] top-auto w-px h-px overflow-hidden focus:left-1/2 focus:-translate-x-1/2 focus:top-2 focus:w-auto focus:h-auto focus:overflow-auto bg-accent text-white p-4 rounded-lg z-50">
            Skip to content
          </a>
          <Header sectionRefs={sectionRefs} />
          <main id="main" className="flex-grow">
            <AboutSection ref={aboutRef} />
            <ProjectsSection ref={projectsRef} onProjectSelect={openProjectModal} />
            <ContactSection ref={contactRef} />
          </main>
          <Footer />
          {selectedProject && <ProjectModal project={selectedProject} onClose={closeProjectModal} />}
        </div>
      );
    };

    // --- From index.tsx ---
    const rootElement = document.getElementById('root');
    const root = ReactDOM.createRoot(rootElement);
    root.render(<App />);

  </script>
</body>
</html>
